{
  "$schema": "https://vega.github.io/schema/vega-lite/v4.json",
  "config": {"background": "#e6edf0"},
  "description": "Bitcoin close",
  "title": {
    "text": " Chart 7: Bitcoin Price",
    "subtitle": "8 Hour interval price at close in $ using CoinApi's API source: CoinAPI.com",
    "subtitleFontStyle": "italic",
    "subtitleFontSize": 10,
    "anchor": "start",
    "color": "black",
    "subtitleColor": "black"
  },
  "data": {
    "url": "https://rest.coinapi.io/v1/ohlcv/BTC/USD/history?period_id=8HRS&time_start=2021-02-06T00:00:00&limit=100000&include_empty_items=false&apikey=92B6B077-C0EF-434B-B876-82F597B782DF"
  },
  "height": 350,
  "width": 350,
  "transform": [
    {"calculate": "'$'+datum.price_close", "as": "price_close_dollars"},
    {"calculate": "'$'+datum.price_high", "as": "price_high_dollars"},
    {
      "calculate": "month(datum.time_period_start)",
      "as": "month_time_period_start"
    },
    {"filter": "datum.month_time_period_start>minMonth"},
    {"filter": "datum.month_time_period_start<maxMonth"}
  ],
  "mark": {
    "type": "area",
    "clip": true,
    "line": {"color": "#0d84b3"},
    "color": {
      "x1": 1,
      "y1": 1,
      "x2": 1,
      "y2": 0,
      "gradient": "linear",
      "stops": [
        {"offset": 0.2, "color": "#e6edf0"},
        {"offset": 1, "color": "#0d84b3"}
      ]
    }
  },
  "params": [
    {
      "name": "minMonth",
      "value": 0,
      "bind": {
        "input": "range",
        "min": 0,
        "max": 12,
        "step": 1,
        "name": "Start month:"
      }
    },
    {
      "name": "maxMonth",
      "value": 12,
      "bind": {
        "input": "range",
        "min": 0,
        "max": 12,
        "step": 1,
        "name": "End month:"
      }
    }
  ],
  "encoding": {
    "x": {
      "field": "time_period_start",
      "type": "temporal",
      "axis": {
        "title": "Date",
        "grid": false,
        "labelSeparation": 20,
        "ticks": false
      }
    },
    "y": {
      "field": "price_close",
      "type": "quantitative",
      "title": "Closing Price ($)",
      "axis": {"grid": false}
    },
    "tooltip": [
      {"field": "time_period_start", "title": "Date", "type": "temporal"},
      {"field": "price_close_dollars", "title": "Closing Price"},
      {"field": "volume_traded", "title": "Volume", "type": "quantitative"},
      {"field": "price_high_dollars", "title": "High"}
    ]
  }
}